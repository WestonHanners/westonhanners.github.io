<!DOCTYPE html>
<html lang="en">
<head>
<!-- Made with Liquid -->
<meta charset=""/>
<base href="/"/>
<title> alloc-init - page 4 | alloc-init</title>



<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@westonhanners"/>
<meta name="twitter:creator" content="@westonhanners"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content=" alloc-init - page 4 |  alloc-init"/>
<meta property="og:description" content=""/>
<meta property="og:url" content="http://alloc-init.com//page/4/index.html"/>
<meta property="og:site_name" content="alloc-init"/>
<meta property="fb:admins" content="weston.hanners"/>
<meta property="og:image" content="images/logo-v3-1000x1000.png" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="test/assets/css/main.css, " type="text/css"/>
<link rel="icon" href="images/logo-v3-16x16.png" sizes="16x16" />
<link rel="icon" href="images/logo-v3-32x32.png" sizes="32x32" />
<link rel="icon" href="images/logo-v3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="images/logo-v3-180x180.png" />
</head>

<body>
<header class="header">
<div class="banner">
	<a href="./">
	...alloc] init];
	</a>
</div>
<div class="navcontainer">
<div id="topnav" class="navitems">
<a href="./">[Home]</a>
<a href="./about">[about me]</a>
<a href="./resources">[resources]</a>
<a href="./stuff">[stuff]</a>
<a href="./posts">[posts]</a>
<a href="https://twitter.com/WestonHanners">[Twitter]</a>
<a href="https://github.com/WestonHanners">[Github]</a>
</div>

<div class="icon">
	<a href="javascript:void(0);" onclick="toggleNav()">&#9776;</a>
</div>

</div>
</header>
<div class="article-list">

<section class="content">
<article>
<h1 class="article-title"><a href=/blog/2015.08.25>Inheriting Equatable in Swift</a></h2>

<h4 class="date-line">Published on Aug 25th, 2015</h4>

<div><p>Today, I was working on creating some Swift objects that needed to
conform to the Equatable protocol. Generally this is quite easy as you
just implement the == function for the class.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func ==(rhs: , lhs: ) -&gt; Bool {
    return 
}
</code></pre></div></div>

<p>The issue is these functions are required to be global (that’s the way
operator declarations work in Swift), so there is no easy way to inherit
your equality from super classes. Here is an incredibly contrived
example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Person: Equatable {
    var name: String = ""
}

class Employee: Person {
    var position: String = ""
}

func ==(lhs: Person, rhs: Person) -&gt; Bool {
    return lhs.name == rhs.name
}

func ==(lhs: Employee, rhs: Employee) -&gt; Bool {
    return lhs.name == rhs.name &amp;&amp; lhs.postion == rhs.position
}
</code></pre></div></div>

<p>Say we want to implement Equatable for
both of these classes. We will want Equatable for Person objects to mean
they have the same name (this is really all we have in this class, but
pretend it was more complicated). Employees can have the same name, but
their equality will also depend on their position (manager, worker,
owner, etc..). We don’t want to have to reimplement the Person ==
functionality in our subclass, usually you would want to call to super,
but since Swift operators are global, you have no sense of super.
The solution is actually quite simple when you think about it. You want
to move the Equatable logic into the classes where they can call to
super. Just have your == function call into equalTo() on your instances,
you can create it like this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func ==(lhs: Person, rhs: Person) -&gt; Bool {
    return lhs.equalTo(rhs)
}

func equalTo(person: Person) -&gt; Bool {
    return self.name == person.name
}
</code></pre></div></div>

<p>Now you can then easily call the equalTo() function in your parent
class. Here is the the completed solution, and <a href="downloads/Equatable.playground.zip">Playground</a>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func ==(lhs: Person, rhs: Person) -&gt; Bool {
    return equalTo(rhs)
}

func ==(lhs: Employee, rhs: Employee) -&gt; Bool {
    return lhs.equalTo(rhs)
}

class Person: Equatable {

    var name: String = "Bob"

    func equalTo(person: Person) -&gt; Bool {
        return self.name == person.name
    }
}

class Employee: Person {

    var position: String = "Manager"

    func equalTo(person: Employee) -&gt; Bool {
        var match = super.equalTo(person)
        match = match &amp;&amp; self.position == person.position
        return match
    }
}
</code></pre></div></div>

<blockquote>
  <p>This was tested on Swift 1.2</p>
</blockquote>

<p><strong>UPDATE 11/6/2015:</strong> Creating an isEqual function on NSObject subclasses was causing issues, changing to
equalTo() fixes this.</p>

</div>
</article>
<hr class="article-divider" />
</section>

<section class="content">
<article>
<h1 class="article-title"><a href=/blog/2015.08.24>NSCoding class chaining with Swift</a></h2>

<h4 class="date-line">Published on Aug 24th, 2015</h4>

<div><p>While I was trying to get some Swift classes to conform to
NSCoding so that I could serialize them, I found out that it can be a
little annoying to get the init(coder:) calls to chain through your
class hierarchy. All of the resources I found online suggested that my
initializers need to be declared as convenience, however if I declared
them as such, they would complain that you need to call self’s
designated initializer. I could remove the convenience, but this is
quite annoying because it forced me to do all of my initialization with
a coder. After a little research, I discovered that I needed to remove
the convenience AND make sure I also override the default init. I
believe the issue is that the default init is marked as designated and
forces your subclasses to call init(), if you override without required,
you can call a different initializer from a subclass. Here is a short
example and a <a href="downloads/NSCoding-Playground.zip">Playground</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Person: NSObject, NSCoding {

    var name: String = "Bob"

    override init() {
        super.init()
    }

    required init(coder aDecoder: NSCoder) {
        self.name = aDecoder.decodeObjectForKey("name") as! String
    }

    func encodeWithCoder(aCoder: NSCoder) {
        aCoder.encodeObject(self.name, forKey: "name")
    }
}

class Employee: Person {

    var position: String = "Manager"

    override init() {
        super.init()
    }

    required init(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        self.position = aDecoder.decodeObjectForKey("position") as! String
    }

    override func encodeWithCoder(aCoder: NSCoder) {
        super.encodeWithCoder(aCoder)
        aCoder.encodeObject(self.position, forKey: "position") 
    }
}

var person = Employee()
person.name = "Bill"
person.position = "Worker"

print(person.name)
print(person.position)

let data = NSKeyedArchiver.archivedDataWithRootObject(person)
let newPerson = NSKeyedUnarchiver.unarchiveObjectWithData(data) as? Employee

print(person.name)
print(person.position)
</code></pre></div></div>

<blockquote>
  <p>This has been tested with Swift 1.2</p>
</blockquote>

</div>
</article>
<hr class="article-divider" />
</section>

<section class="content">
<article>
<h1 class="article-title"><a href=/blog/2015.01.14>Remove that shadow!</a></h2>

<h4 class="date-line">Published on Jan 14th, 2015</h4>

<div><p>UIKit can be so frustrating sometimes. I was trying to remove a shadow
from UINavigationBar, and it turns out there is a property for doing this…</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>navigationBar.shadow = &amp;lt;something&amp;gt;
</code></pre></div></div>

<p>Perfect! or not… Apparently, it only works if
you have a custom image as your bar background</p>

<blockquote>
  <p>The default value is nil, which corresponds to the
default shadow image. When non-nil, this property
represents a custom shadow image to show instead of the default. For a
custom shadow image to be shown, a custom background image must also
be set with
the setBackgroundImage:forBarMetrics: method. If the
default background image is used, then the default shadow image will
be used regardless of the value of this property.</p>
</blockquote>

<p>So, I cannot use a solid colored background without a shadow… after
looking around online, I found bunch of extensions on UIImage that
returns an image of a given size and color, but I felt that custom
drawing was a little overkill here. My solution is as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>extension UINavigationBar {
    
    func removeShadow() {
        if let view = removeShadowFromView(self) {
            view.hidden = true
        }
    }
    
    func removeShadowFromView(view: UIView) -&gt; UIImageView? {
        if (view.isKindOfClass(UIImageView) &amp;&amp; view.bounds.size.height &lt;= 1) {
            return view as? UIImageView
        }
        for subView in view.subviews {
            if let imageView = removeShadowFromView(subView as UIView) {
                return imageView
            }
        }
        return nil
    }   
}
</code></pre></div></div>

<p>This way, I simply call</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>navigationController?.navigationBar.removeShadow()
</code></pre></div></div>

<p><img src="images/noshadow.png" alt="No Shadow" /></p>

<p>and all is right with the world. Feel free to use this extension in your
own work, it’s nothing particularly genius, but it sure helps me out.
This is based on some Objective-C code I found <a href="http://stackoverflow.com/a/19227158/713940">here</a></p>

<p><strong>Update for iOS 10:</strong> I changed the above code so it “hides” the shadow, rather than
removing it. This is confirmed working on both iOS 9 and 10. The
removeFromSuperview() method doesn’t work on iOS 10.</p>

</div>
</article>
<hr class="article-divider" />
</section>

<section class="content">
<article>
<h1 class="article-title"><a href=/blog/2014.08.19>Concerning Swift</a></h2>

<h4 class="date-line">Published on Aug 19th, 2014</h4>

<div><p><img src="images/Swift-no-Banner.png" alt="swift 1-point-no" /></p>

<p>I came across an excellent <a href="https://ericasadun.com/2014/08/11/swift-what-does-1-0-mean/">article</a> by Erica Sadun talking about her
experiences with the Xcode Betas and her expectations of Swift 1.0, and I think
it was a nice dose of reality. (…And not only because I have a domain that will
be obsolete in a post Objective-C world.)</p>

<p>It’s nice to pretend that we will all be writing Swift apps by the end of the
year, but if this <a href="https://github.com/ksm/SwiftInFlux">git repo</a> is any indication, we will have a little while
to go before the language is stable enough for prime time.</p>

<p>I feel sorry for all the people who decided that Swift was their excuse to start
learning iOS development, because of all the strange quirks with Objective-C
compatibility, it won’t be as easy as picking up a Swift book and writing an
app. There will be challenges and changes for at least the next year and
possibly longer. As it is now, you will have to update your Swift apps very
often to keep up with what will certainly be many revisions of the language.</p>

<p>I have a friend who I am trying to teach iOS development, and even though it
will be available fairly soon, I have urged him to pretend that Swift doesn’t
exist for the time being, and I urge the same to anyone else just starting out.</p>

<p>I intend to practice what I preach, while I will undoubtably tinker with Swift
over the next several months (I am not completely nuts), I will not do any
serious writing in it until they at least start updating the Cocoa API’s to be
a bit more Swift-like.</p>

</div>
</article>
<hr class="article-divider" />
</section>

<section class="content">
<article>
<h1 class="article-title"><a href=/blog/2014.08.04>How I Finally Understood Swift Optionals</a></h2>

<h4 class="date-line">Published on Aug 4th, 2014</h4>

<div><p>I had a bit of trouble understanding Swift Optionals. When should I use
a question mark, and when should I use an exclamation point? The iBook
was a bit confusing on this point for me. Until I was sitting at
IndyCocoaHeads last night and <a href="https://twitter.com/theredheadnerd">@AndyDuff</a> was giving a talk
about Swift. When he got to the part about Optionals, something finally
clicked for me and I was able to finally understand them.</p>

<h2 id="optionals-are-like-schrödingers-cat">Optionals are like Schrödinger’s Cat!</h2>

<p>Think of it like this, you can have an integer, and we all know that
integers are whole numbers (-1, 0, 1 , 2, 3…) within a certain range
depending on what type of system you are on. In Swift you would declare
it as such:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var n: Int = 23
</code></pre></div></div>

<p>The compiler does not need the type here, but I included it for clarity.
This is telling the compiler that while, n “could” be any integer, here,
it’s 23. Now lets look at an Optional:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var n: Int? = 23
</code></pre></div></div>

<p>In this line we are telling the compiler something else. Currently n
is 23, but n “could” be any integer <strong>OR nil</strong>. If you are familiar with
Objective-C, this is quite familiar with NS objects. NSString can equal 
@”Hello, World” but you can also set it to nil, which is not a string,
or any type for that matter. This is why I like to say it’s
like <a href="http://en.wikipedia.org/wiki/Schrödinger's_cat">Schrödinger’s Cat</a> If you are not familiar with the concept, 
I believe <a href="http://www.explainxkcd.com/wiki/index.php/45:_Schrodinger">this link</a> is a fun place to start. Essentially the variable 
can contain a value, or nil (the cat is either alive or dead), but we don’t 
know until we check.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (n != nil) {
    println("n = \(n!)." // Note the ! after n.
}
</code></pre></div></div>

<p>Once you are 100% sure that n <em>does</em> have a value, then you can force it
to behave like a normal integer by using “<strong>!</strong>”, if you use ! and n is
a nil value, then your app will crash.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var n: Int? // Optionals default their initial value to nil.
println("n = \(n)." // This will crash because it's trying to print nil.
</code></pre></div></div>

<p>Once you get the hang of it, it becomes natural and feels like things we
have done in Objective-C for quite some time now just we now have access
to this feature on “Primitive” types.</p>

</div>
</article>
<hr class="article-divider" />
</section>

</div>
<div class="pagination">


<a href="test/page/3/">Newer</a>


<a href="test/page/5/">Older</a>


</div>
<script type="text/javascript" async defer src="/js/navigation.min.js"></script>
<script type="text/javascript" async defer src="/js/asyncyoutube.min.js"></script>

<div class="footer">
    [ ©2019 <a href="http://twitter.com/@WestonHanners">Weston Hanners</a> | <a href="https://alloc-init.com/feed">rss</a> ]
</div>
<!--Powered by Jekyll and Amazon Lightsail, Alloc Theme by Weston Hanners-->

</body>
</html>